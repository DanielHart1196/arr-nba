var N=Object.defineProperty;var R=a=>{throw TypeError(a)};var x=(a,e,t)=>e in a?N(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var k=(a,e,t)=>x(a,typeof e!="symbol"?e+"":e,t),w=(a,e,t)=>e.has(a)||R("Cannot "+t);var s=(a,e,t)=>(w(a,e,"read from private field"),t?t.call(a):e.get(a)),u=(a,e,t)=>e.has(a)?R("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),E=(a,e,t,i)=>(w(a,e,"write to private field"),i?i.call(a,t):e.set(a,t),t);import{R as S,_ as I,$ as T,a0 as B,a1 as D,a2 as F,h as A,a3 as C,a4 as H,a5 as O,a6 as Y,a as L,a7 as P,a8 as $,a9 as j,aa as q,ab as y,ac as z,ad as M}from"./B3tR_vzS.js";var l,d,h,_,v,b,m;class G{constructor(e,t=!0){k(this,"anchor");u(this,l,new Map);u(this,d,new Map);u(this,h,new Map);u(this,_,new Set);u(this,v,!0);u(this,b,()=>{var e=S;if(s(this,l).has(e)){var t=s(this,l).get(e),i=s(this,d).get(t);if(i)I(i),s(this,_).delete(t);else{var o=s(this,h).get(t);o&&(s(this,d).set(t,o.effect),s(this,h).delete(t),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),i=o.effect)}for(const[f,r]of s(this,l)){if(s(this,l).delete(f),f===e)break;const n=s(this,h).get(r);n&&(T(n.effect),s(this,h).delete(r))}for(const[f,r]of s(this,d)){if(f===t||s(this,_).has(f))continue;const n=()=>{if(Array.from(s(this,l).values()).includes(f)){var p=document.createDocumentFragment();H(r,p),p.append(D()),s(this,h).set(f,{effect:r,fragment:p})}else T(r);s(this,_).delete(f),s(this,d).delete(f)};s(this,v)||!i?(s(this,_).add(f),B(r,n,!1)):n()}}});u(this,m,e=>{s(this,l).delete(e);const t=Array.from(s(this,l).values());for(const[i,o]of s(this,h))t.includes(i)||(T(o.effect),s(this,h).delete(i))});this.anchor=e,E(this,v,t)}ensure(e,t){var i=S,o=O();if(t&&!s(this,d).has(e)&&!s(this,h).has(e))if(o){var f=document.createDocumentFragment(),r=D();f.append(r),s(this,h).set(e,{effect:F(()=>t(r)),fragment:f})}else s(this,d).set(e,F(()=>t(this.anchor)));if(s(this,l).set(i,e),o){for(const[n,c]of s(this,d))n===e?i.unskip_effect(c):i.skip_effect(c);for(const[n,c]of s(this,h))n===e?i.unskip_effect(c.effect):i.skip_effect(c.effect);i.oncommit(s(this,b)),i.ondiscard(s(this,m))}else A&&(this.anchor=C),s(this,b).call(this)}}l=new WeakMap,d=new WeakMap,h=new WeakMap,_=new WeakMap,v=new WeakMap,b=new WeakMap,m=new WeakMap;function Q(a,e,t=!1){A&&L();var i=new G(a),o=t?P:0;function f(r,n){if(A){const g=$(a);var c;if(g===j?c=0:g===q?c=!1:c=parseInt(g.substring(1)),r!==c){var p=y();z(p),i.anchor=p,M(!1),i.ensure(r,n),M(!0);return}}i.ensure(r,n)}Y(()=>{var r=!1;e((n,c=0)=>{r=!0,f(c,n)}),r||f(!1,null)},o)}export{G as B,Q as i};
