import{a as F,f as X,t as ut}from"../chunks/DVUZdbEl.js";import"../chunks/D8ZGW8jb.js";import{o as Lt,a as Ut}from"../chunks/BV6NFH77.js";import{z as Bt,A as J,B as Q,C as Ft,l as t,u as w,D as h,E as I,F as b,G as v,m as V}from"../chunks/mOB0g_sz.js";import{s as T}from"../chunks/Dk1Swlgz.js";import{i as ht}from"../chunks/DYJ-5WiK.js";import{c as kt,n as S,p as Ct,e as Ht,g as A,i as Mt}from"../chunks/ChMNwxDu.js";import{s as mt}from"../chunks/WbGyEyQw.js";import{e as R}from"../chunks/Dmu6a9U4.js";import{b as $t}from"../chunks/DlvNiFL_.js";import{i as zt}from"../chunks/DCl0DeTE.js";import{p as Gt}from"../chunks/CN7CQmFo.js";function k(p){const g=p.getFullYear(),f=String(p.getMonth()+1).padStart(2,"0"),u=String(p.getDate()).padStart(2,"0");return`${g}${f}${u}`}function W(p,g){const f=new Date(p);return f.setDate(f.getDate()+g),f}function Ot(p,g){try{return new Date(p.date).toDateString()===g}catch{return!1}}function Pt(p){const g=Array.from(new Map(p.map(f=>[f.id,f])).values());return g.sort((f,u)=>new Date(f.date).getTime()-new Date(u.date).getTime()),g}function jt(p){var L,U,m,B,E,j;const g=((U=(L=p==null?void 0:p.competitions)==null?void 0:L[0])==null?void 0:U.competitors)??[],f=(B=(m=g.find(N=>N.homeAway==="away"))==null?void 0:m.team)==null?void 0:B.displayName,u=(j=(E=g.find(N=>N.homeAway==="home"))==null?void 0:E.team)==null?void 0:j.displayName;return!f||!u?null:{awayName:f,homeName:u}}var qt=X('<div class="text-white/70">No games found...</div>'),Kt=X('<a class="block border border-white/10 rounded p-3 hover:border-white/20"><div class="grid grid-cols-[auto_1fr_auto_1fr_auto] gap-x-2 items-center"><div class="row-span-2 justify-self-center"><img alt="away" width="48" height="48" loading="lazy" decoding="async"/></div> <div class="text-center font-medium"> </div> <div class="text-center text-white/70 font-medium">@</div> <div class="text-center font-medium"> </div> <div class="row-span-2 justify-self-center"><img alt="home" width="48" height="48" loading="lazy" decoding="async"/></div> <div class="text-center"> </div> <div class="text-center text-white/70 whitespace-nowrap"><!></div> <div class="text-center"> </div></div></a>'),Yt=X('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"></div>'),Zt=X('<div class="p-4 min-h-screen swipe-area" style="touch-action: pan-y;"><div class="flex items-center justify-between mb-4"><h1 class="text-2xl font-semibold">ARR NBA</h1> <div class="flex items-center gap-2"><div class="flex items-center bg-white/5 border border-white/10 rounded overflow-hidden"><button class="px-3 py-1 hover:bg-white/10 border-r border-white/10">Prev</button> <span class="px-4 py-1 text-sm font-medium min-w-[200px] text-center"> </span> <button class="px-3 py-1 hover:bg-white/10 border-l border-white/10">Next</button></div> <button class="px-3 py-1 rounded border border-white/10 bg-white/10 text-white/90"> </button></div></div> <!></div>');function ne(p,g){Bt(g,!1);let f=Gt(g,"data",8),u=J(f().events??[]),L,U=!1,m=J(new Date);async function B(){if(!U){U=!0;try{const e=t(m).toDateString();try{sessionStorage.setItem("arrnba.selectedDate",t(m).toISOString())}catch{}const o=new Date(t(m)),y=W(t(m),-1),a=W(t(m),1),l=Z=>Ot(Z,e),x=await S.getScoreboard(k(o));x&&x.events&&I(u,(x.events??[]).filter(l));const[C,K,H]=await Promise.all([S.getScoreboard(k(o)),S.getScoreboard(k(y)),S.getScoreboard(k(a))]),it=(C.events??[]).filter(l),M=(K.events??[]).filter(l),nt=(H.events??[]).filter(l),$=[...M,...it,...nt];I(u,Pt($)),gt(t(u));const Y=W(t(m),2),z=W(t(m),-2);S.getScoreboard(k(Y)).catch(()=>{}),S.getScoreboard(k(z)).catch(()=>{})}catch(e){console.error("Failed to refresh scoreboard:",e)}finally{U=!1}}}function E(e){t(m).setDate(t(m).getDate()+e),I(m,new Date(t(m))),B()}function j(e){return e.toLocaleDateString(void 0,{weekday:"long",month:"short",day:"numeric"})}let N;async function tt(e){N&&clearTimeout(N),N=setTimeout(async()=>{const o=jt(e);if(!o)return;const{awayName:y,homeName:a}=o;try{await Ct(S,y,a)}catch(l){console.error(`Failed to preload Reddit data for ${y} vs ${a}:`,l)}},150)}async function gt(e){try{const o=e.map(y=>y.id).filter(Boolean);if(o.length===0)return;S.prewarmBoxscores(o).catch(()=>{})}catch(o){console.error("Failed to prewarm boxscores:",o)}}let et=J();Lt(()=>{try{const e=sessionStorage.getItem("arrnba.selectedDate");e&&I(m,new Date(e));const o=localStorage.getItem("arrnba.hideScores");I(_,o==="1")}catch{}L=setInterval(B,15e3),kt({target:t(et),onSwipeRight:()=>E(-1),onSwipeLeft:()=>E(1),threshold:50}),B().then(()=>{yt()}),(async()=>{try{await S.getRedditIndex()}catch(e){console.error("Failed to load Reddit index:",e)}})()});function yt(){t(u).forEach(e=>{var y,a,l,x;const o=(x=(l=(a=(y=e==null?void 0:e.competitions)==null?void 0:y[0])==null?void 0:a.status)==null?void 0:l.type)==null?void 0:x.name;(o==="STATUS_IN_PROGRESS"||o==="STATUS_HALFTIME")&&tt(e)})}Ut(()=>{L&&clearInterval(L)});function wt(e){try{const o=new Date(e),y=o.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",hour12:!1}),a=o.toLocaleTimeString("en-AU",{timeZoneName:"short"}).split(" ").pop();return`${y} ${a}`}catch{return""}}let _=J(!1);function bt(){I(_,!t(_));try{localStorage.setItem("arrnba.hideScores",t(_)?"1":"0")}catch{}}function lt(e){const o=e.currentTarget;o&&(o.style.display="none")}zt();var q=Zt(),at=h(q),vt=b(h(at),2),rt=h(vt),pt=h(rt),ot=b(pt,2),St=h(ot,!0);v(ot);var _t=b(ot,2);v(rt);var st=b(rt,2),xt=h(st,!0);v(st),v(vt),v(at);var Dt=b(at,2);{var Tt=e=>{var o=qt();F(e,o)},At=e=>{var o=Yt();Ht(o,5,()=>t(u),Mt,(y,a)=>{var l=Kt(),x=h(l),C=h(x),K=h(C);v(C);var H=b(C,2),it=h(H,!0);v(H);var M=b(H,4),nt=h(M,!0);v(M);var $=b(M,2),Y=h($);v($);var z=b($,2),Z=h(z,!0);v(z);var ct=b(z,2),Et=h(ct);{var Nt=i=>{var r=ut();Q(s=>T(r,s),[()=>(t(a),w(()=>wt(t(a).date)))]),F(i,r)},It=i=>{var r=ut();Q(()=>T(r,(t(a),w(()=>{var s,n,c,d,D;return(D=(d=(c=(n=(s=t(a))==null?void 0:s.competitions)==null?void 0:n[0])==null?void 0:c.status)==null?void 0:d.type)==null?void 0:D.shortDetail})))),F(i,r)};ht(Et,i=>{t(a),w(()=>{var r,s,n,c,d;return((d=(c=(n=(s=(r=t(a))==null?void 0:r.competitions)==null?void 0:s[0])==null?void 0:n.status)==null?void 0:c.type)==null?void 0:d.name)==="STATUS_SCHEDULED"})?i(Nt):i(It,!1)})}v(ct);var ft=b(ct,2),Rt=h(ft,!0);v(ft),v(x),v(l),Q((i,r,s,n,c,d)=>{mt(l,"href",(t(a),w(()=>`/game/${t(a).id}`))),mt(K,"src",i),T(it,r),T(nt,s),mt(Y,"src",n),T(Z,c),T(Rt,d)},[()=>(V(A),t(a),w(()=>{var i,r,s,n,c;return`/logos/${A((c=(n=(s=(r=(i=t(a))==null?void 0:i.competitions)==null?void 0:r[0])==null?void 0:s.competitors)==null?void 0:n.find(d=>d.homeAway==="away"))==null?void 0:c.team)}.svg`})),()=>(V(A),t(a),w(()=>{var i,r,s,n,c;return A((c=(n=(s=(r=(i=t(a))==null?void 0:i.competitions)==null?void 0:r[0])==null?void 0:s.competitors)==null?void 0:n.find(d=>d.homeAway==="away"))==null?void 0:c.team)})),()=>(V(A),t(a),w(()=>{var i,r,s,n,c;return A((c=(n=(s=(r=(i=t(a))==null?void 0:i.competitions)==null?void 0:r[0])==null?void 0:s.competitors)==null?void 0:n.find(d=>d.homeAway==="home"))==null?void 0:c.team)})),()=>(V(A),t(a),w(()=>{var i,r,s,n,c;return`/logos/${A((c=(n=(s=(r=(i=t(a))==null?void 0:i.competitions)==null?void 0:r[0])==null?void 0:s.competitors)==null?void 0:n.find(d=>d.homeAway==="home"))==null?void 0:c.team)}.svg`})),()=>(t(a),t(_),w(()=>{var i,r,s,n,c,d,D,G,O,P;return((c=(n=(s=(r=(i=t(a))==null?void 0:i.competitions)==null?void 0:r[0])==null?void 0:s.status)==null?void 0:n.type)==null?void 0:c.name)==="STATUS_SCHEDULED"||t(_)?"-":((P=(O=(G=(D=(d=t(a))==null?void 0:d.competitions)==null?void 0:D[0])==null?void 0:G.competitors)==null?void 0:O.find(dt=>dt.homeAway==="away"))==null?void 0:P.score)??0})),()=>(t(a),t(_),w(()=>{var i,r,s,n,c,d,D,G,O,P;return((c=(n=(s=(r=(i=t(a))==null?void 0:i.competitions)==null?void 0:r[0])==null?void 0:s.status)==null?void 0:n.type)==null?void 0:c.name)==="STATUS_SCHEDULED"||t(_)?"-":((P=(O=(G=(D=(d=t(a))==null?void 0:d.competitions)==null?void 0:D[0])==null?void 0:G.competitors)==null?void 0:O.find(dt=>dt.homeAway==="home"))==null?void 0:P.score)??0}))]),R("error",K,lt),R("error",Y,lt),R("mouseenter",l,()=>{tt(t(a)),S.getBoxscore(t(a).id).catch(()=>{})}),R("touchstart",l,()=>{tt(t(a)),S.getBoxscore(t(a).id).catch(()=>{})}),F(y,l)}),v(o),F(e,o)};ht(Dt,e=>{t(u),w(()=>!t(u)||t(u).length===0)?e(Tt):e(At,!1)})}v(q),$t(q,e=>I(et,e),()=>t(et)),Q(e=>{T(St,e),T(xt,t(_)?"Show Scores":"Hide Scores")},[()=>(t(m),w(()=>j(t(m))))]),R("click",pt,()=>E(-1)),R("click",_t,()=>E(1)),R("click",st,bt),F(p,q),Ft()}export{ne as component};
